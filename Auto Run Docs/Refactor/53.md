# Refactor Task 53: src/renderer/slashCommands.ts

## Summary

This is a minimal 20-line file that defines the built-in Maestro slash commands and their interface. While the file itself is clean, there are significant issues with **type duplication** (SlashCommand interface defined 4 times) and **definition inconsistency** (mobile has deprecated commands not in desktop).

## Dead Code

None found - the file exports a single interface and a single command array, both of which are actively used.

**Usage verification:**
- `slashCommands` is imported by `src/renderer/App.tsx:9`
- `SlashCommand` interface is re-defined locally in 3 other files instead of being imported

## Deprecated Patterns

1. **Mobile retains deprecated commands** (src/web/mobile/SlashCommandAutocomplete.tsx:37-52)
   - Mobile's `DEFAULT_SLASH_COMMANDS` includes `/clear` and `/jump`
   - Per ARCHITECTURE.md line 526: "The built-in slash commands (`/clear`, `/jump`, `/history`) have been deprecated in favor of fully customizable commands defined in Settings"
   - Desktop's `slashCommands` array only has `/history`, which is correct
   - Mobile interface is out of sync with this deprecation

## Duplication

1. **SlashCommand interface defined 4 times:**
   - `src/renderer/slashCommands.ts:4-9` (canonical location)
   - `src/renderer/components/MainPanel.tsx:18-21` (local interface, missing optional fields)
   - `src/renderer/components/InputArea.tsx:10-15` (local interface)
   - `src/web/mobile/SlashCommandAutocomplete.tsx:22-31` (local interface with JSDoc)

2. **Command definitions duplicated between desktop and mobile:**
   - Desktop: `src/renderer/slashCommands.ts:13-19` - only `/history`
   - Mobile: `src/web/mobile/SlashCommandAutocomplete.tsx:37-52` - `/history`, `/clear`, `/jump`
   - Description text for `/history` differs:
     - Desktop: "Generate a synopsis of recent work and add to history"
     - Mobile: "Get a synopsis of work since the last /history and add to history"

3. **MainPanel.tsx has incomplete interface:**
   - Missing `terminalOnly?: boolean` and `aiOnly?: boolean` properties
   - This could cause type errors if these properties are accessed

## Code Smells

None found - the file is appropriately minimal (20 lines).

## Type Safety Issues

1. **Local interface definitions bypass the canonical export** (Medium)
   - `MainPanel.tsx` and `InputArea.tsx` define their own `SlashCommand` interface locally
   - This means changes to the canonical interface won't propagate
   - Risk: MainPanel's interface is already missing `terminalOnly` and `aiOnly` fields

2. **No shared type location** (Low)
   - `SlashCommand` should be in `src/shared/types.ts` for use by both renderer and web/mobile
   - Currently, each consumer re-defines the interface

## Recommended Refactoring

1. **Move SlashCommand interface to shared/types.ts** (Medium priority)
   - Consolidate all 4 interface definitions into one shared location
   - Update all imports to use the shared type
   - Files to update: slashCommands.ts, MainPanel.tsx, InputArea.tsx, SlashCommandAutocomplete.tsx

2. **Remove deprecated /clear and /jump from mobile** (Medium priority)
   - Update `DEFAULT_SLASH_COMMANDS` in SlashCommandAutocomplete.tsx
   - Align with desktop behavior (only `/history` as built-in)
   - Per ARCHITECTURE.md, these are now user-customizable in Settings

3. **Harmonize description text** (Low priority)
   - Make `/history` description consistent between desktop and mobile
   - Choose one: "Generate a synopsis..." vs "Get a synopsis..."

4. **Add unit tests for slashCommands.ts** (Low priority)
   - No tests exist for this file
   - While trivial, tests would catch regressions when commands are added/removed
   - Related test file exists: `src/__tests__/web/mobile/SlashCommandAutocomplete.test.tsx`

5. **Consider exporting from index** (Low priority)
   - Create `src/renderer/slashCommands/index.ts` pattern if more commands are expected
   - Current single-file approach is appropriate for the minimal content

## Estimated Impact

**Risk Level:** Low
- Changes are isolated to type definitions and command lists
- No complex logic or side effects

**Testing Considerations:**
- Verify slash command autocomplete works in both desktop and mobile after type consolidation
- Test that `/history` command still functions correctly after any changes
- Update test mocks that define local SlashCommand types

**Dependencies:**
- Mobile web interface depends on `DEFAULT_SLASH_COMMANDS`
- Desktop App.tsx depends on `slashCommands` array
- InputArea and MainPanel receive commands as props
